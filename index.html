<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>M. Zilani Attorneys | Paperless Law Firm Demo</title>
  <style>
    :root {
      --bg: #f4f2ef;
      --card: #ffffff;
      --border: #e2ddd6;
      --text: #25211c;
      --muted: #6f665b;
      --primary: #8d6f3a;
      --primary-dark: #70572d;
      --accent: #1f2937;
      --ok-bg: #ecfdf3;
      --ok-text: #05603a;
      --chip-bg: #f0e7d8;
      --shadow: 0 4px 14px rgba(37, 33, 28, 0.08);
    }

    * { box-sizing: border-box; font-family: "Segoe UI", Arial, sans-serif; }
    body { margin: 0; background: var(--bg); color: var(--text); }

    header {
      background: linear-gradient(120deg, var(--accent), #374151);
      color: #fff;
      padding: 1.4rem 1rem;
    }

    h1 { margin: 0; font-size: 1.4rem; }
    header p { margin: 0.45rem 0 0; opacity: 0.95; max-width: 960px; }

    .layout {
      display: grid;
      grid-template-columns: 290px 1fr;
      gap: 1rem;
      padding: 1rem;
      align-items: start;
    }

    .panel, .card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 0.95rem;
    }

    .panel h2, .card h2 { margin: 0 0 0.72rem; font-size: 1.02rem; }

    .nav-list { display: grid; gap: 0.5rem; }

    .nav-button {
      width: 100%;
      text-align: left;
      border: 1px solid var(--border);
      background: #fbf8f3;
      color: var(--text);
      border-radius: 9px;
      padding: 0.62rem;
      cursor: pointer;
      font-weight: 600;
    }

    .nav-button.active, .nav-button:hover {
      background: #f3e9d6;
      border-color: #d7c29c;
    }

    .chips { display: flex; gap: 0.45rem; flex-wrap: wrap; margin-top: 0.45rem; }
    .chip { background: var(--chip-bg); color: #674c1f; padding: 0.22rem 0.58rem; border-radius: 999px; font-size: 0.76rem; }

    .content { display: grid; gap: 1rem; }

    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 0.65rem;
    }

    .kpi {
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 0.72rem;
      background: #faf8f4;
    }

    .kpi small { color: var(--muted); display: block; }
    .kpi strong { display: block; font-size: 1.22rem; color: var(--primary-dark); margin-top: 0.2rem; }

    .two-col {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 1rem;
    }

    label {
      display: block;
      font-size: 0.87rem;
      font-weight: 600;
      margin: 0.6rem 0 0.28rem;
    }

    input, select, textarea, button {
      width: 100%;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 0.58rem;
      font-size: 0.93rem;
    }

    textarea { min-height: 92px; resize: vertical; }

    button {
      margin-top: 0.8rem;
      border: none;
      background: var(--primary);
      color: #fff;
      font-weight: 600;
      cursor: pointer;
    }

    button:hover { background: var(--primary-dark); }

    .btn-secondary { background: #4b5563; }
    .btn-secondary:hover { background: #374151; }

    .result {
      margin-top: 0.75rem;
      display: none;
      border: 1px solid #bdeecf;
      background: var(--ok-bg);
      color: var(--ok-text);
      padding: 0.62rem;
      border-radius: 8px;
      font-size: 0.9rem;
    }

    .table { width: 100%; border-collapse: collapse; font-size: 0.89rem; margin-top: 0.5rem; }
    .table th, .table td { border-bottom: 1px solid var(--border); text-align: left; vertical-align: top; padding: 0.52rem; }

    .muted { color: var(--muted); font-size: 0.84rem; }

    .meeting-link {
      display: inline-block;
      margin-top: 0.35rem;
      color: #1d4ed8;
      font-size: 0.83rem;
      text-decoration: none;
    }

    .meeting-link:hover { text-decoration: underline; }

    @media (max-width: 980px) {
      .layout { grid-template-columns: 1fr; }
      .kpi-grid { grid-template-columns: 1fr 1fr; }
    }
  </style>
</head>
<body>
  <header>
    <h1>M. Zilani Attorneys — Paperless Operations Portal (Demo)</h1>
    <p>Designed for a small legal team in Mthatha to migrate paper files, capture voice-based case notes, onboard clients digitally, and run virtual consultations.</p>
  </header>

  <main class="layout">
    <aside class="panel">
      <h2>Demo Workflow</h2>
      <div id="navList" class="nav-list"></div>

      <h2 style="margin-top: 1rem;">Practice Profile</h2>
      <div class="chips">
        <span class="chip">Mthatha, Eastern Cape</span>
        <span class="chip">3–4 Team Members</span>
        <span class="chip">Conveyancing + RAF + Family Law</span>
      </div>
      <p class="muted" style="margin-top: 0.7rem;">Demo mode: OCR, dictation, WhatsApp, and email steps are simulated.</p>
    </aside>

    <section id="content" class="content"></section>
  </main>

  <script>
    const STORAGE_KEY = "mzilani-paperless-demo-v1";

    const seed = {
      staff: [
        { id: "s1", name: "Adv. M. Zilani", role: "Principal Attorney" },
        { id: "s2", name: "L. Nondaba", role: "Candidate Attorney" },
        { id: "s3", name: "P. Mvundle", role: "Admin Clerk" },
        { id: "s4", name: "A. Mkhize", role: "Reception" }
      ],
      clients: [
        { id: "c1", name: "Sipho Ndlovu", contact: "083 352 6632", matterType: "RAF Claim", intake: "Voice + Upload" },
        { id: "c2", name: "Nomsa Cakwe", contact: "zilaniattorneys@gmail.com", matterType: "Property Transfer", intake: "Portal Form" }
      ],
      matters: [
        {
          id: "m1",
          clientId: "c1",
          title: "RAF Loss of Support",
          status: "In Progress",
          nextDate: "2026-03-10",
          digitalDocs: 9,
          source: "Scanned Archive"
        },
        {
          id: "m2",
          clientId: "c2",
          title: "Conveyancing - Erf 223",
          status: "Pending FICA",
          nextDate: "2026-02-26",
          digitalDocs: 4,
          source: "Online Intake"
        }
      ],
      scans: [],
      voiceNotes: [],
      meetings: [],
      outbox: []
    };

    const views = [
      { id: "dashboard", label: "Firm Dashboard" },
      { id: "migration", label: "Paper File Migration" },
      { id: "voice", label: "Voice-to-Case Notes" },
      { id: "onboarding", label: "Client Onboarding" },
      { id: "consultations", label: "Virtual Consultations" },
      { id: "outbox", label: "Client Comms Log" }
    ];

    let state = loadState();
    let activeView = "dashboard";

    const navList = document.getElementById("navList");
    const content = document.getElementById("content");

    function loadState() {
      const raw = localStorage.getItem(STORAGE_KEY);
      if (!raw) return structuredClone(seed);
      try {
        return JSON.parse(raw);
      } catch {
        return structuredClone(seed);
      }
    }

    function persist() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    function resetDemoData() {
      state = structuredClone(seed);
      persist();
      render();
    }

    function clientById(id) {
      return state.clients.find((client) => client.id === id);
    }

    function clientOptions() {
      return state.clients.map((client) => `<option value="${client.id}">${client.name} — ${client.matterType}</option>`).join("");
    }

    function matterOptions() {
      return state.matters.map((matter) => {
        const client = clientById(matter.clientId);
        return `<option value="${matter.id}">${matter.title} (${client?.name || "Unknown client"})</option>`;
      }).join("");
    }

    function queueMessage({ recipient, channel, subject, body }) {
      state.outbox.unshift({
        id: `msg-${Date.now()}`,
        recipient,
        channel,
        subject,
        body,
        at: new Date().toLocaleString()
      });
      persist();
    }

    function renderNav() {
      navList.innerHTML = "";
      views.forEach((view) => {
        const button = document.createElement("button");
        button.className = `nav-button ${activeView === view.id ? "active" : ""}`;
        button.textContent = view.label;
        button.onclick = () => {
          activeView = view.id;
          render();
        };
        navList.appendChild(button);
      });
    }

    function dashboardView() {
      const totalDocs = state.matters.reduce((sum, matter) => sum + matter.digitalDocs, 0) + state.scans.length;
      const paperlessProgress = state.matters.length ? Math.round((state.matters.filter((matter) => matter.digitalDocs >= 5).length / state.matters.length) * 100) : 0;

      return `
      <article class="card">
        <h2>Paperless Progress Snapshot</h2>
        <div class="kpi-grid">
          <div class="kpi"><small>Active Clients</small><strong>${state.clients.length}</strong></div>
          <div class="kpi"><small>Active Matters</small><strong>${state.matters.length}</strong></div>
          <div class="kpi"><small>Digitised Documents</small><strong>${totalDocs}</strong></div>
          <div class="kpi"><small>Paperless Readiness</small><strong>${paperlessProgress}%</strong></div>
        </div>
        <p class="muted" style="margin-top:0.65rem;">Use this dashboard during your demo to show progress from physical files to a searchable case portal.</p>
        <button id="resetBtn" type="button">Reset Demo Data</button>
      </article>

      <article class="card">
        <h2>Current Matters Register</h2>
        <table class="table">
          <thead><tr><th>Matter</th><th>Client</th><th>Status</th><th>Next Date</th><th>Digital Docs</th><th>Source</th></tr></thead>
          <tbody>
            ${state.matters.map((matter) => `
              <tr>
                <td>${matter.title}</td>
                <td>${clientById(matter.clientId)?.name || "Unknown"}</td>
                <td>${matter.status}</td>
                <td>${matter.nextDate}</td>
                <td>${matter.digitalDocs}</td>
                <td>${matter.source}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      </article>`;
    }

    function migrationView() {
      return `
      <article class="card">
        <h2>Scan Paper Files & Attach to Matter</h2>
        <form id="scanForm">
          <label>Choose matter</label>
          <select required name="matterId">${matterOptions()}</select>

          <label>Document type</label>
          <select required name="docType">
            <option>Client ID / FICA</option>
            <option>Court Pleadings</option>
            <option>Affidavit</option>
            <option>Property Transfer Docs</option>
            <option>RAF Medical Report</option>
            <option>Correspondence</option>
          </select>

          <label>Upload scanned file</label>
          <input required name="file" type="file" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx" />

          <label>OCR summary preview (editable)</label>
          <textarea required name="ocrSummary" placeholder="Auto-extracted text appears here for quick correction before saving."></textarea>

          <button type="submit">Save to Digital File</button>
          <div id="scanResult" class="result"></div>
        </form>
      </article>`;
    }

    function voiceView() {
      return `
      <article class="card">
        <h2>Voice-to-Case Notes (Attorney Dictation)</h2>
        <form id="voiceForm">
          <label>Select matter</label>
          <select required name="matterId">${matterOptions()}</select>

          <label>Dictation language</label>
          <select name="language">
            <option value="en-ZA">English (South Africa)</option>
            <option value="xh-ZA">isiXhosa (South Africa)</option>
          </select>

          <button type="button" id="startDictation" class="btn-secondary">Start Voice Capture</button>

          <label>Transcript / notes</label>
          <textarea required name="transcript" id="voiceTranscript" placeholder="Speak and let the system type, or paste from your AI assistant."></textarea>

          <button type="submit">Save Case Note</button>
          <div id="voiceResult" class="result"></div>
          <p class="muted">If browser speech recognition is unavailable, you can still paste transcript text from Gemini or another dictation tool.</p>
        </form>
      </article>`;
    }

    function onboardingView() {
      return `
      <article class="card">
        <h2>Digital Client Intake & Case Opening</h2>
        <form id="onboardForm">
          <label>Client full name</label>
          <input required name="name" placeholder="e.g. Babalwa Mhlanga" />

          <label>Mobile number / email</label>
          <input required name="contact" placeholder="e.g. 082 xxx xxxx or email" />

          <label>Legal service type</label>
          <select required name="matterType">
            <option>Divorce / Family Law</option>
            <option>RAF Claim</option>
            <option>Conveyancing</option>
            <option>Labour Dispute</option>
            <option>Criminal Matter</option>
            <option>Civil Litigation</option>
          </select>

          <label>Case summary</label>
          <textarea required name="summary" placeholder="Short description of the issue."></textarea>

          <label>Consent capture (digital signature)</label>
          <input required name="signature" placeholder="Type client full name as signature" />

          <button type="submit">Create Client + Open Matter + Send Welcome Link</button>
          <div id="onboardResult" class="result"></div>
        </form>
      </article>`;
    }

    function consultationsView() {
      return `
      <article class="card">
        <h2>Virtual Meetings & Consultations</h2>
        <form id="meetingForm">
          <label>Client</label>
          <select required name="clientId">${clientOptions()}</select>

          <label>Meeting date</label>
          <input required type="date" name="date" />

          <label>Meeting time</label>
          <input required type="time" name="time" />

          <label>Purpose</label>
          <input required name="purpose" placeholder="Consultation / update / document review" />

          <label>Platform</label>
          <select required name="platform"><option>Google Meet</option><option>Zoom</option><option>Microsoft Teams</option><option>WhatsApp Video</option></select>

          <button type="submit">Schedule & Notify Client</button>
          <div id="meetingResult" class="result"></div>
        </form>
      </article>

      <article class="card">
        <h2>Upcoming Consultations</h2>
        <table class="table">
          <thead><tr><th>Date</th><th>Client</th><th>Purpose</th><th>Platform</th><th>Link</th></tr></thead>
          <tbody>
            ${state.meetings.length ? state.meetings.map((meeting) => `
              <tr>
                <td>${meeting.date} ${meeting.time}</td>
                <td>${clientById(meeting.clientId)?.name || "Unknown"}</td>
                <td>${meeting.purpose}</td>
                <td>${meeting.platform}</td>
                <td><a class="meeting-link" href="${meeting.link}" target="_blank">${meeting.link}</a></td>
              </tr>
            `).join("") : `<tr><td colspan="5">No consultations scheduled yet.</td></tr>`}
          </tbody>
        </table>
      </article>`;
    }

    function outboxView() {
      return `
      <article class="card">
        <h2>Client Communication Log (Email / SMS / WhatsApp Simulation)</h2>
        <table class="table">
          <thead><tr><th>Time</th><th>Recipient</th><th>Channel</th><th>Subject</th></tr></thead>
          <tbody>
            ${state.outbox.length ? state.outbox.map((message) => `
              <tr>
                <td>${message.at}</td>
                <td>${message.recipient}</td>
                <td>${message.channel}</td>
                <td>${message.subject}</td>
              </tr>
            `).join("") : `<tr><td colspan="4">No communications sent yet.</td></tr>`}
          </tbody>
        </table>
      </article>`;
    }

    function bindDashboard() {
      document.getElementById("resetBtn").onclick = resetDemoData;
    }

    function bindMigration() {
      const form = document.getElementById("scanForm");
      const result = document.getElementById("scanResult");

      form.onsubmit = (event) => {
        event.preventDefault();
        const data = new FormData(form);
        const matterId = data.get("matterId");
        const file = data.get("file");
        const matter = state.matters.find((item) => item.id === matterId);

        state.scans.push({
          id: `scan-${Date.now()}`,
          matterId,
          docType: data.get("docType"),
          fileName: file?.name || "unknown",
          ocrSummary: data.get("ocrSummary")
        });

        if (matter) matter.digitalDocs += 1;

        queueMessage({
          recipient: "Internal Team",
          channel: "Email",
          subject: `New scanned document saved for ${matter?.title || "matter"}`,
          body: `${file?.name || "File"} uploaded and indexed.`
        });

        persist();
        result.style.display = "block";
        result.textContent = `${file?.name || "Document"} added to ${matter?.title || "selected matter"} and indexed for search.`;
        form.reset();
      };
    }

    function bindVoice() {
      const form = document.getElementById("voiceForm");
      const result = document.getElementById("voiceResult");
      const transcript = document.getElementById("voiceTranscript");
      const startButton = document.getElementById("startDictation");

      startButton.onclick = () => {
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
          startButton.textContent = "Speech not supported in this browser";
          return;
        }

        const recognition = new SpeechRecognition();
        recognition.lang = form.language.value;
        recognition.interimResults = true;
        recognition.continuous = false;

        startButton.textContent = "Listening...";

        recognition.onresult = (event) => {
          let text = "";
          for (let i = event.resultIndex; i < event.results.length; i += 1) {
            text += event.results[i][0].transcript;
          }
          transcript.value = `${transcript.value} ${text}`.trim();
        };

        recognition.onend = () => {
          startButton.textContent = "Start Voice Capture";
        };

        recognition.start();
      };

      form.onsubmit = (event) => {
        event.preventDefault();
        const data = new FormData(form);
        const matter = state.matters.find((item) => item.id === data.get("matterId"));

        state.voiceNotes.unshift({
          id: `voice-${Date.now()}`,
          matterId: data.get("matterId"),
          language: data.get("language"),
          transcript: data.get("transcript")
        });

        queueMessage({
          recipient: "Matter File",
          channel: "Internal Log",
          subject: `Voice note saved for ${matter?.title || "matter"}`,
          body: String(data.get("transcript")).slice(0, 120)
        });

        persist();
        result.style.display = "block";
        result.textContent = `Voice case note saved under ${matter?.title || "selected matter"}.`;
        form.reset();
      };
    }

    function bindOnboarding() {
      const form = document.getElementById("onboardForm");
      const result = document.getElementById("onboardResult");

      form.onsubmit = (event) => {
        event.preventDefault();
        const data = new FormData(form);

        const client = {
          id: `c-${Date.now()}`,
          name: data.get("name"),
          contact: data.get("contact"),
          matterType: data.get("matterType"),
          intake: "Portal Form"
        };

        state.clients.push(client);

        const matter = {
          id: `m-${Date.now()}`,
          clientId: client.id,
          title: `${data.get("matterType")} - ${data.get("name")}`,
          status: "Intake Complete",
          nextDate: new Date().toISOString().slice(0, 10),
          digitalDocs: 1,
          source: "Online Intake"
        };

        state.matters.push(matter);

        queueMessage({
          recipient: client.contact,
          channel: "WhatsApp",
          subject: `Welcome ${client.name}`,
          body: `Your legal matter has been opened. Next step: upload IDs and supporting evidence.`
        });

        persist();
        result.style.display = "block";
        result.textContent = `${client.name} onboarded successfully. Matter opened and welcome message queued.`;
        form.reset();
      };
    }

    function bindConsultations() {
      const form = document.getElementById("meetingForm");
      const result = document.getElementById("meetingResult");

      form.onsubmit = (event) => {
        event.preventDefault();
        const data = new FormData(form);
        const client = clientById(data.get("clientId"));

        const meeting = {
          id: `meet-${Date.now()}`,
          clientId: data.get("clientId"),
          date: data.get("date"),
          time: data.get("time"),
          purpose: data.get("purpose"),
          platform: data.get("platform"),
          link: `https://meet.demo/${Math.random().toString(36).slice(2, 9)}`
        };

        state.meetings.unshift(meeting);

        queueMessage({
          recipient: client?.contact || "Client",
          channel: "SMS",
          subject: `Virtual consultation scheduled (${meeting.platform})`,
          body: `${meeting.date} ${meeting.time} — ${meeting.link}`
        });

        persist();
        result.style.display = "block";
        result.textContent = `Consultation scheduled for ${client?.name || "client"}; invite sent with meeting link.`;
        render();
      };
    }

    function render() {
      renderNav();

      if (activeView === "dashboard") {
        content.innerHTML = dashboardView();
        bindDashboard();
      } else if (activeView === "migration") {
        content.innerHTML = migrationView();
        bindMigration();
      } else if (activeView === "voice") {
        content.innerHTML = voiceView();
        bindVoice();
      } else if (activeView === "onboarding") {
        content.innerHTML = onboardingView();
        bindOnboarding();
      } else if (activeView === "consultations") {
        content.innerHTML = consultationsView();
        bindConsultations();
      } else if (activeView === "outbox") {
        content.innerHTML = outboxView();
      }
    }

    render();
  </script>
</body>
</html>
